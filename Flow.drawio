<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36" version="29.2.7">
  <diagram id="Ed-4rrUc83cEgYUhoCOA" name="Complete Workflow">
    <mxGraphModel dx="4074" dy="2237" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-1" parent="1" style="swimlane;fillColor=#f5f5f5;strokeColor=#666666;fontStyle=1;fontSize=16;" value="PHASE 0: STARTUP" vertex="1">
          <mxGeometry height="200" width="1300" x="50" y="50" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-2" parent="0Rd1Ei7NkYxjBYbKHXew-1" style="ellipse;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=3;fontSize=14;fontStyle=1;" value="START&#xa;BasicAV.exe" vertex="1">
          <mxGeometry height="100" width="140" x="50" y="50" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-3" parent="0Rd1Ei7NkYxjBYbKHXew-1" style="whiteSpace=wrap;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;align=left;" value="initialize_system()&#xa;&#xa;1. init_database()&#xa;   → Open BasicAV.sqlite3&#xa;   → CREATE TABLE scanned_files&#xa;   → CREATE TABLE malware_hashes&#xa;   → strcpy(DB_PATH, path)" vertex="1">
          <mxGeometry height="120" width="280" x="250" y="40" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-4" parent="0Rd1Ei7NkYxjBYbKHXew-1" style="whiteSpace=wrap;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;align=left;" value="load_malware_csv()&#xa;&#xa;IF (full.csv exists)&#xa;   → Import 100k+ signatures&#xa;ELSE&#xa;   → Import recent.csv (24h)&#xa;&#xa;Transaction batching (10k/commit)" vertex="1">
          <mxGeometry height="120" width="300" x="590" y="40" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-5" parent="0Rd1Ei7NkYxjBYbKHXew-1" style="rhombus;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;" value="is_first_run()?&#xa;&#xa;Check if&#xa;Database\first_run.txt&#xa;exists" vertex="1">
          <mxGeometry height="100" width="200" x="950" y="50" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-6" edge="1" parent="0Rd1Ei7NkYxjBYbKHXew-1" source="0Rd1Ei7NkYxjBYbKHXew-2" target="0Rd1Ei7NkYxjBYbKHXew-3" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-7" edge="1" parent="0Rd1Ei7NkYxjBYbKHXew-1" source="0Rd1Ei7NkYxjBYbKHXew-3" target="0Rd1Ei7NkYxjBYbKHXew-4" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-8" edge="1" parent="0Rd1Ei7NkYxjBYbKHXew-1" source="0Rd1Ei7NkYxjBYbKHXew-4" target="0Rd1Ei7NkYxjBYbKHXew-5" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-9" parent="1" style="swimlane;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1;fontSize=16;" value="PHASE 1A: FIRST RUN WORKFLOW" vertex="1">
          <mxGeometry height="550" width="600" x="50" y="300" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-10" parent="0Rd1Ei7NkYxjBYbKHXew-9" style="whiteSpace=wrap;fillColor=#f8cecc;strokeColor=#b85450;strokeWidth=2;fontStyle=1;" value="first_run.txt&#xa;NOT FOUND" vertex="1">
          <mxGeometry height="60" width="200" x="200" y="50" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-11" parent="0Rd1Ei7NkYxjBYbKHXew-9" style="whiteSpace=wrap;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;align=left;" value="fast_scan_critical_directory()&#xa;&#xa;Scan these folders:&#xa;• Downloads&#xa;• Desktop&#xa;• AppData\Local\Temp&#xa;• Windows\Temp&#xa;• Documents&#xa;&#xa;Expand %USERNAME%" vertex="1">
          <mxGeometry height="140" width="400" x="100" y="140" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-12" parent="0Rd1Ei7NkYxjBYbKHXew-9" style="whiteSpace=wrap;fillColor=#ffe6cc;strokeColor=#d79b00;strokeWidth=2;align=left;" value="FOR EACH FILE:&#xa;&#xa;1. scan_directory(path)&#xa;   → FindFirstFileA()&#xa;   → FindNextFileA()&#xa;   → RECURSIVE&#xa;&#xa;2. calculate_file_hash(filepath)&#xa;   → CryptoAPI SHA-256&#xa;   → Chunk-based (128KB)&#xa;&#xa;3. insert_file_record(filepath, hash)&#xa;   → INSERT INTO scanned_files&#xa;   → Prepared statement" vertex="1">
          <mxGeometry height="170" width="440" x="80" y="310" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-13" parent="0Rd1Ei7NkYxjBYbKHXew-9" style="whiteSpace=wrap;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=2;" value="mark_first_run_complete()&#xa;&#xa;Create file:&#xa;Database\first_run.txt" vertex="1">
          <mxGeometry height="80" width="300" x="150" y="500" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-14" edge="1" parent="0Rd1Ei7NkYxjBYbKHXew-9" source="0Rd1Ei7NkYxjBYbKHXew-10" target="0Rd1Ei7NkYxjBYbKHXew-11" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-15" edge="1" parent="0Rd1Ei7NkYxjBYbKHXew-9" source="0Rd1Ei7NkYxjBYbKHXew-11" target="0Rd1Ei7NkYxjBYbKHXew-12" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-16" edge="1" parent="0Rd1Ei7NkYxjBYbKHXew-9" source="0Rd1Ei7NkYxjBYbKHXew-12" target="0Rd1Ei7NkYxjBYbKHXew-13" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-17" parent="1" style="swimlane;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1;fontSize=16;" value="PHASE 1B: NORMAL RUN WORKFLOW" vertex="1">
          <mxGeometry height="240" width="600" x="750" y="300" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-18" parent="0Rd1Ei7NkYxjBYbKHXew-17" style="whiteSpace=wrap;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=2;fontStyle=1;" value="first_run.txt&#xa;EXISTS" vertex="1">
          <mxGeometry height="60" width="200" x="200" y="50" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-19" parent="0Rd1Ei7NkYxjBYbKHXew-17" style="whiteSpace=wrap;fillColor=#e1d5e7;strokeColor=#9673a6;strokeWidth=2;align=left;" value="Skip full scan&#xa;&#xa;Database already populated&#xa;with file hashes&#xa;&#xa;(Future: Real-time monitor&#xa;would run here)" vertex="1">
          <mxGeometry height="120" width="300" x="150" y="140" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-20" edge="1" parent="0Rd1Ei7NkYxjBYbKHXew-17" source="0Rd1Ei7NkYxjBYbKHXew-18" target="0Rd1Ei7NkYxjBYbKHXew-19" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-21" edge="1" parent="1" source="0Rd1Ei7NkYxjBYbKHXew-5" style="strokeWidth=2;strokeColor=#b85450;" target="0Rd1Ei7NkYxjBYbKHXew-10" value="NO">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="800" y="250" />
              <mxPoint x="350" y="250" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-22" edge="1" parent="1" source="0Rd1Ei7NkYxjBYbKHXew-5" style="strokeWidth=2;strokeColor=#82b366;" target="0Rd1Ei7NkYxjBYbKHXew-18" value="YES">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1100" y="250" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-23" parent="1" style="swimlane;fillColor=#ffe6cc;strokeColor=#d79b00;fontStyle=1;fontSize=16;" value="PHASE 2: THREAT DETECTION" vertex="1">
          <mxGeometry height="650" width="1300" x="50" y="900" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-24" parent="0Rd1Ei7NkYxjBYbKHXew-23" style="whiteSpace=wrap;fillColor=#f5f5f5;strokeColor=#666666;strokeWidth=3;fontStyle=1;" value="MERGE POINT&#xa;(Both paths continue here)" vertex="1">
          <mxGeometry height="60" width="200" x="550" y="40" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-25" parent="0Rd1Ei7NkYxjBYbKHXew-23" style="whiteSpace=wrap;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;align=left;" value="1. init_report(&amp;report)&#xa;&#xa;malloc(sizeof(ThreatInfo) * 10)&#xa;report.threats = allocated_memory&#xa;report.count = 0&#xa;report.capacity = 10" vertex="1">
          <mxGeometry height="120" width="300" x="100" y="140" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-26" parent="0Rd1Ei7NkYxjBYbKHXew-23" style="whiteSpace=wrap;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;align=left;" value="2. compare_hashes(&amp;report)&#xa;&#xa;SQL Query:&#xa;SELECT s.filepath, s.sha256_hash, s.scan_date,&#xa;       m.file_name, m.file_type, m.first_seen, m.reporter&#xa;FROM scanned_files s&#xa;INNER JOIN malware_hashes m&#xa;  ON s.sha256_hash = m.sha256&#xa;&#xa;sqlite3_prepare_v2()&#xa;sqlite3_step() → Loop through results" vertex="1">
          <mxGeometry height="180" width="400" x="450" y="140" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-27" parent="0Rd1Ei7NkYxjBYbKHXew-23" style="whiteSpace=wrap;fillColor=#ffe6cc;strokeColor=#d79b00;strokeWidth=2;align=left;" value="FOR EACH MATCH:&#xa;&#xa;3. add_threat(&amp;report, &amp;threat)&#xa;&#xa;   IF (report.count &gt;= report.capacity)&#xa;      realloc(capacity * 2)&#xa;   &#xa;   strncpy(report.threats[count].filepath, ...)&#xa;   strncpy(report.threats[count].sha256_hash, ...)&#xa;   strncpy(report.threats[count].malware_name, ...)&#xa;   ... (7 fields total)&#xa;   &#xa;   report.count++" vertex="1">
          <mxGeometry height="220" width="350" x="900" y="140" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-28" parent="0Rd1Ei7NkYxjBYbKHXew-23" style="whiteSpace=wrap;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;align=left;" value="4. generate_csv_report()&#xa;&#xa;fopen(&quot;threats.csv&quot;, &quot;w&quot;)&#xa;fprintf(header line)&#xa;FOR (i = 0; i &lt; report.count; i++)&#xa;   fprintf(7 columns)&#xa;fclose()" vertex="1">
          <mxGeometry height="140" width="300" x="100" y="400" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-29" parent="0Rd1Ei7NkYxjBYbKHXew-23" style="whiteSpace=wrap;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;align=left;" value="5. generate_html_report()&#xa;&#xa;fopen(&quot;threats.html&quot;, &quot;w&quot;)&#xa;fprintf(HTML header + CSS)&#xa;&#xa;Query: SELECT COUNT(*) FROM scanned_files&#xa;→ Display in dashboard card&#xa;&#xa;FOR (i = 0; i &lt; report.count; i++)&#xa;   fprintf(table row with 7 columns)&#xa;&#xa;fprintf(HTML footer)&#xa;fclose()" vertex="1">
          <mxGeometry height="180" width="380" x="450" y="380" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-30" parent="0Rd1Ei7NkYxjBYbKHXew-23" style="whiteSpace=wrap;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=2;align=left;" value="6. cleanup_report()&#xa;&#xa;free(report.threats)&#xa;report.threats = NULL&#xa;report.count = 0&#xa;report.capacity = 0" vertex="1">
          <mxGeometry height="120" width="300" x="880" y="400" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-31" parent="0Rd1Ei7NkYxjBYbKHXew-23" style="rhombus;fillColor=#fff2cc;strokeColor=#d6b656;strokeWidth=2;" value="Threats found?" vertex="1">
          <mxGeometry height="100" width="160" x="570" y="570" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-32" edge="1" parent="0Rd1Ei7NkYxjBYbKHXew-23" source="0Rd1Ei7NkYxjBYbKHXew-24" target="0Rd1Ei7NkYxjBYbKHXew-25" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="250" y="120" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-33" edge="1" parent="0Rd1Ei7NkYxjBYbKHXew-23" source="0Rd1Ei7NkYxjBYbKHXew-25" target="0Rd1Ei7NkYxjBYbKHXew-26" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="420" y="200" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-34" edge="1" parent="0Rd1Ei7NkYxjBYbKHXew-23" source="0Rd1Ei7NkYxjBYbKHXew-26" style="strokeColor=#d79b00;strokeWidth=2;" target="0Rd1Ei7NkYxjBYbKHXew-27" value="callback">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-35" edge="1" parent="0Rd1Ei7NkYxjBYbKHXew-23" source="0Rd1Ei7NkYxjBYbKHXew-27" target="0Rd1Ei7NkYxjBYbKHXew-28" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1075" y="380" />
              <mxPoint x="250" y="380" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-36" edge="1" parent="0Rd1Ei7NkYxjBYbKHXew-23" source="0Rd1Ei7NkYxjBYbKHXew-28" target="0Rd1Ei7NkYxjBYbKHXew-29" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="420" y="470" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-37" edge="1" parent="0Rd1Ei7NkYxjBYbKHXew-23" source="0Rd1Ei7NkYxjBYbKHXew-29" target="0Rd1Ei7NkYxjBYbKHXew-30" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="850" y="470" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-38" edge="1" parent="0Rd1Ei7NkYxjBYbKHXew-23" source="0Rd1Ei7NkYxjBYbKHXew-30" target="0Rd1Ei7NkYxjBYbKHXew-31" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1030" y="550" />
              <mxPoint x="650" y="550" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-39" edge="1" parent="1" source="0Rd1Ei7NkYxjBYbKHXew-13" style="strokeWidth=2;" target="0Rd1Ei7NkYxjBYbKHXew-24" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="350" y="880" />
              <mxPoint x="650" y="880" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-40" edge="1" parent="1" source="0Rd1Ei7NkYxjBYbKHXew-19" style="strokeWidth=2;" target="0Rd1Ei7NkYxjBYbKHXew-24" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1050" y="600" />
              <mxPoint x="1050" y="880" />
              <mxPoint x="650" y="880" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-41" parent="1" style="swimlane;fillColor=#f5f5f5;strokeColor=#666666;fontStyle=1;fontSize=16;" value="PHASE 3: OUTPUT" vertex="1">
          <mxGeometry height="280" width="1300" x="50" y="1600" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-42" parent="0Rd1Ei7NkYxjBYbKHXew-41" style="whiteSpace=wrap;fillColor=#f8cecc;strokeColor=#b85450;strokeWidth=2;align=left;" value="IF (count &gt; 0)&#xa;&#xa;Display WARNING:&#xa;• Log to console&#xa;• Show threat count&#xa;• Open threats.html&#xa;&#xa;Recommend user action:&#xa;• Delete files&#xa;• Quarantine&#xa;• Submit to analysis" vertex="1">
          <mxGeometry height="160" width="400" x="100" y="80" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-43" parent="0Rd1Ei7NkYxjBYbKHXew-41" style="whiteSpace=wrap;fillColor=#d5e8d4;strokeColor=#82b366;strokeWidth=2;align=left;" value="IF (count == 0)&#xa;&#xa;Display SUCCESS:&#xa;• System is clean&#xa;• No threats found&#xa;• Log success message" vertex="1">
          <mxGeometry height="160" width="400" x="800" y="80" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-44" parent="0Rd1Ei7NkYxjBYbKHXew-41" style="ellipse;fillColor=#f5f5f5;strokeColor=#666666;strokeWidth=3;fontSize=14;fontStyle=1;" value="END&#xa;Exit program" vertex="1">
          <mxGeometry height="80" width="140" x="580" y="120" as="geometry" />
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-45" edge="1" parent="1" source="0Rd1Ei7NkYxjBYbKHXew-31" style="strokeWidth=2;strokeColor=#b85450;" target="0Rd1Ei7NkYxjBYbKHXew-42" value="YES">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="300" y="1520" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-46" edge="1" parent="1" source="0Rd1Ei7NkYxjBYbKHXew-31" style="strokeWidth=2;strokeColor=#82b366;" target="0Rd1Ei7NkYxjBYbKHXew-43" value="NO">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1000" y="1520" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-47" edge="1" parent="1" source="0Rd1Ei7NkYxjBYbKHXew-42" target="0Rd1Ei7NkYxjBYbKHXew-44" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="300" y="1850" />
              <mxPoint x="630" y="1850" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="0Rd1Ei7NkYxjBYbKHXew-48" edge="1" parent="1" source="0Rd1Ei7NkYxjBYbKHXew-43" target="0Rd1Ei7NkYxjBYbKHXew-44" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1000" y="1850" />
              <mxPoint x="680" y="1850" />
            </Array>
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
